# Plop generator to create Loopback 3 application test suites

This micro generator creates a suite of tests based on the Loopback 3 definitions of an API.

This kind of generator avoids you spend time writing the repetitive part of the test suites.

Of course, you can customize the templates to get the test files that you want.

The specs used to create the test are obtained using the Loopback 3 CLI.

The generated tests use the [supertest](https://github.com/visionmedia/supertest) library to make the HTTP requests to the Loopbak 3 API under test. These tests are a bit slower but they check the API behaviour like if the API were in production.

## Get the api specs

```shell
lb export-api-def --json > testing_data/specs.json
```

## Signed-in and Not-signed-in test

There is two generators. The former creates test to test the API with a signed-in user. The second one tests the API with a not signed in user.


## How to use this tests

-   Install the necessary dependencies in your project:

```shell
npm install --save-dev mocha chai supertest cross-env
```

-   Create a directory folder similar to the example (see below).

-   Copy the test files generated by the plopfile.

-   Edit each file and customize the tests

-   Run the tests

**Important note:** this tests use some auxiliary files to create and login the users during the tests. You can find examples of such code in the example referred below.

## Example

There is an example of how to test an Loopback 3 API in the directory called **examples**.

To run the example:

```shell
cd examples
npm install
npm test
```

### Example details

The test directory structure is

<pre>
test---+
       |
       +- api -+
               |
               +-- models
               |
               +-- utils
               |
               +-- specs
</pre>

*  **models** contains the tests suite for each model in the API generated using the plopfile.

*  **utils** contains the auxiliary code to create and sign-in the users during the testing.

*  **specs** contains the API specs.
